# Epic 1.2: 프론트엔드 직접 비디오 업로드 UI 및 S3 연동

## ✅ 완료된 작업 (DoD)

### 1. Drag & Drop 파일 업로드 UI 컴포넌트 추가 (shadcn/ui 활용)
- ✅ `VideoUpload.tsx` 컴포넌트 생성
- ✅ 드래그 앤 드롭 인터페이스 구현
- ✅ 파일 선택 버튼 (클릭 업로드) 지원
- ✅ 비디오 파일 형식 검증 (video/*)
- ✅ 파일 정보 표시 (이름, 크기)
- ✅ shadcn/ui 컴포넌트 활용 (Card, Button, Progress)

### 2. gRPC-web을 통해 백엔드에 Presigned URL 요청
- ✅ Protobuf TypeScript 코드 재생성
- ✅ `GetUploadURL` RPC 메서드 호출 구현
- ✅ 요청 파라미터 전달:
  - `filename`: 파일명
  - `contentType`: MIME 타입
  - `fileSize`: 파일 크기
  - `userId`: 사용자 ID

### 3. 발급받은 URL을 사용하여 S3에 파일 직접 업로드 (axios 활용)
- ✅ axios 라이브러리 설치
- ✅ Presigned URL로 PUT 요청 구현
- ✅ Content-Type 헤더 설정
- ✅ 업로드 성공/실패 처리
- ✅ 에러 핸들링 및 재시도 기능

### 4. 업로드 진행률(Progress bar) UI 구현
- ✅ axios `onUploadProgress` 콜백 활용
- ✅ 실시간 진행률 계산 (0-100%)
- ✅ Progress 컴포넌트로 시각화
- ✅ 업로드 상태 표시 (idle, uploading, success, error)
- ✅ 상태별 아이콘 표시 (CheckCircle, AlertCircle)

## 📁 생성/수정된 파일

```
frontend/
├── src/
│   ├── components/
│   │   └── VideoUpload.tsx                 # 신규: 드래그 앤 드롭 업로드 컴포넌트
│   ├── pages/
│   │   └── Index.tsx                       # 수정: 탭 UI 추가 (URL/Upload)
│   └── generated/
│       └── analysis.ts                     # 재생성: GetUploadURL 포함
├── proto/
│   └── analysis.proto                      # 업데이트: 백엔드와 동기화
└── package.json                            # 수정: axios 의존성 추가
```

## 🎨 UI/UX 특징

### 드래그 앤 드롭 영역
- 파일을 드래그하면 시각적 피드백 (테두리 색상 변경)
- 클릭으로도 파일 선택 가능
- 비디오 파일만 허용 (다른 형식은 토스트 알림)

### 업로드 진행 상태
1. **Idle**: 파일 선택 후 "업로드 시작" 버튼 표시
2. **Uploading**: 진행률 바와 퍼센트 표시
3. **Success**: 체크 아이콘과 "다른 파일 업로드" 버튼
4. **Error**: 경고 아이콘과 "다시 시도" / "취소" 버튼

### 탭 인터페이스
- **URL 입력**: 기존 YouTube URL 분석
- **파일 업로드**: 로컬 동영상 직접 업로드

## 🧪 테스트 방법

### 1. 로컬 개발 서버 실행
```bash
cd frontend
npm run dev
```

### 2. 업로드 테스트
1. 브라우저에서 `http://localhost:5173` 접속
2. "파일 업로드" 탭 클릭
3. 동영상 파일을 드래그 앤 드롭 또는 클릭하여 선택
4. "업로드 시작" 버튼 클릭
5. 진행률 바 확인
6. 업로드 완료 후 토스트 알림 확인

### 3. 예상 동작
- Presigned URL 요청 → 백엔드 gRPC 호출
- S3 직접 업로드 → AWS S3 PUT 요청
- 진행률 실시간 업데이트 → 0% → 100%
- 성공 시 체크 아이콘 표시

## 🔐 보안 고려사항

1. **클라이언트 측 검증**: 파일 형식 검증 (video/* MIME 타입)
2. **파일 크기 제한**: 현재 제한 없음 (추후 추가 권장)
3. **직접 업로드**: 백엔드를 거치지 않아 서버 부하 최소화
4. **Presigned URL**: 15분 만료로 보안 위험 최소화

## 📊 성능 최적화

- **청크 업로드**: 현재 단일 PUT 요청 (대용량 파일은 추후 멀티파트 업로드 고려)
- **진행률 표시**: 사용자 경험 향상
- **에러 복구**: 재시도 기능으로 네트워크 오류 대응

## 🚀 다음 단계 (Epic 1.3)

- [ ] S3 버킷 이벤트 알림 설정 (Terraform)
- [ ] EventBridge 규칙 생성 (PutObject 이벤트 감지)
- [ ] CloudWatch Logs 연동 테스트
- [ ] 업로드 완료 후 자동 분석 트리거

## 🎉 완료!

Epic 1.2의 모든 DoD가 충족되었습니다. 사용자는 이제 YouTube URL뿐만 아니라 로컬 동영상 파일도 직접 업로드하여 분석할 수 있습니다!

## 📸 스크린샷 (예상)

```
┌─────────────────────────────────────────┐
│  [URL 입력] [파일 업로드]               │
├─────────────────────────────────────────┤
│                                         │
│         ⬆️  Upload Icon                 │
│                                         │
│   동영상을 드래그하거나 클릭하세요        │
│   MP4, MOV, AVI 등 지원                 │
│                                         │
└─────────────────────────────────────────┘

↓ 파일 선택 후

┌─────────────────────────────────────────┐
│  📹 video.mp4                    ✅     │
│     125.5 MB                            │
├─────────────────────────────────────────┤
│  업로드 중...                      75%  │
│  ████████████████░░░░░░░░░░░░░░░       │
└─────────────────────────────────────────┘
```
